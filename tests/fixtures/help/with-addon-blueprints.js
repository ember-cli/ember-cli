const processHelpString = require('../../helpers/process-help-string');
const versionUtils      = require('../../../lib/utilities/version-utils');
var emberCLIVersion   = versionUtils.emberCLIVersion;

module.exports = {
  name: 'ember',
  description: null,
  aliases: [],
  works: 'insideProject',
  availableOptions: [],
  anonymousOptions: ['<command (Default: help)>'],
  version: emberCLIVersion(),
  commands: [
    {
      name: 'addon',
      description: 'Generates a new folder structure for building an addon, complete with test harness.',
      aliases: [],
      works: 'everywhere',
      availableOptions: [
        {
          name: 'dry-run',
          default: false,
          aliases: ['d'],
          key: 'dryRun',
          required: false
        },
        {
          name: 'verbose',
          default: false,
          aliases: ['v'],
          key: 'verbose',
          required: false
        },
        {
          name: 'blueprint',
          default: 'addon',
          aliases: ['b'],
          key: 'blueprint',
          required: false
        },
        {
          name: 'skip-npm',
          default: false,
          aliases: ['sn', 'skip-install', 'si'],
          key: 'skipNpm',
          required: false
        },
        {
          name: 'skip-git',
          default: false,
          aliases: ['sg'],
          key: 'skipGit',
          required: false
        },
        {
          aliases: [{ npm: 'npm' }, { pnpm: 'pnpm' }, { yarn: 'yarn' }],
          key: 'packageManager',
          name: 'package-manager',
          required: false,
          type: ['npm', 'pnpm', 'yarn'],
        },
        {
          name: 'directory',
          aliases: ['dir'],
          key: 'directory',
          required: false
        },
        {
          name: 'lang',
          key: 'lang',
          description: "Sets the base human language of the addon's own test application via index.html",
          required: false
        },
        {
          name: 'lint-fix',
          default: true,
          key: 'lintFix',
          required: false
        },
        {
          name: 'ci-provider',
          key: 'ciProvider',
          type: ['github', 'none'],
          default: 'github',
          description: 'Installs the optional default CI blueprint. Only Github Actions is supported at the moment.',
          required: false
        },
        {
          aliases: ['ts'],
          default: false,
          key: 'typescript',
          name: 'typescript',
          description: 'Set up the addon to use TypeScript',
          required: false,
        },
        {
          default: true,
          description: 'Use GJS/GTS templates by default for generated components, tests, and route templates',
          key: 'strict',
          name: 'strict',
          required: false
        },
      ],
      anonymousOptions: ['<addon-name>']
    },
    {
      name: 'build',
      description: 'Vestigial command in Vite-based projects. Use the `build` script from package.json instead.',
      aliases: ['b'],
      works: 'insideProject',
      availableOptions: [
        {
          name: 'environment',
          description: 'Possible values are "development", "production", and "test".',
          default: 'development',
          aliases: [
            'e',
            { dev: 'development' },
            { prod: 'production' }
          ],
          key: 'environment',
          required: false
        },
        {
          name: 'suppress-sizes',
          default: false,
          key: 'suppressSizes',
          required: false
        }
      ],
      anonymousOptions: []
    },
    {
      name: 'destroy',
      description: 'Destroys code generated by `generate` command.',
      aliases: ['d'],
      works: 'insideProject',
      availableOptions: [
        {
          name: 'dry-run',
          default: false,
          aliases: ['d'],
          key: 'dryRun',
          required: false
        },
        {
          name: 'verbose',
          default: false,
          aliases: ['v'],
          key: 'verbose',
          required: false
        },
        {
          name: 'pod',
          default: false,
          aliases: ['p', 'pods'],
          key: 'pod',
          required: false
        },
        {
          name: 'classic',
          default: false,
          aliases: ['c'],
          key: 'classic',
          required: false
        },
        {
          name: 'in-repo-addon',
          default: null,
          aliases: ['in-repo', 'ir'],
          key: 'inRepoAddon',
          required: false
        },
        {
          name: 'in',
          default: null,
          description: 'Runs a blueprint against an in repo addon. A path is expected, relative to the root of the project.',
          key: 'in',
          required: false
        },
        {
          name: 'typescript',
          aliases: ['ts'],
          description: 'Specifically destroys the TypeScript output of the `generate` command. Run `--no-typescript` to instead target the JavaScript output.',
          key: 'typescript',
          required: false
        }
      ],
      anonymousOptions: ['<blueprint>']
    },
    {
      name: 'generate',
      description: 'Generates new code from blueprints.',
      aliases: ['g'],
      works: 'insideProject',
      availableOptions: [
        {
          name: 'dry-run',
          default: false,
          aliases: ['d'],
          key: 'dryRun',
          required: false
        },
        {
          name: 'verbose',
          default: false,
          aliases: ['v'],
          key: 'verbose',
          required: false
        },
        {
          name: 'pod',
          default: false,
          aliases: ['p', 'pods'],
          key: 'pod',
          required: false
        },
        {
          name: 'classic',
          default: false,
          aliases: ['c'],
          key: 'classic',
          required: false
        },
        {
          name: 'in-repo-addon',
          default: null,
          aliases: ['in-repo', 'ir'],
          key: 'inRepoAddon',
          required: false
        },
        {
          name: 'lint-fix',
          default: true,
          key: 'lintFix',
          required: false
        },
        {
          name: 'in',
          default: null,
          description: 'Runs a blueprint against an in repo addon. A path is expected, relative to the root of the project.',
          key: 'in',
          required: false
        },
        {
          name: 'typescript',
          aliases: ['ts'],
          description: 'Generates a version of the blueprint written in TypeScript (if available).',
          key: 'typescript',
          required: false
        },
      ],
      anonymousOptions: ['<blueprint>'],
      availableBlueprints: [
        {
          fixtures: [
            {
              name: 'basic',
              description: 'A basic blueprint',
              availableOptions: [],
              anonymousOptions: ['name'],
              overridden: false
            },
            {
              name: 'basic_2',
              description: 'Another basic blueprint',
              availableOptions: [],
              anonymousOptions: ['name'],
              overridden: false
            },
            {
              name: 'exporting-object',
              description: 'A blueprint that exports an object',
              availableOptions: [],
              anonymousOptions: ['name'],
              overridden: false
            },
            {
              name: 'with-templating',
              description: 'A blueprint with templating',
              availableOptions: [],
              anonymousOptions: ['name'],
              overridden: false
            }
          ]
        },
        {
          'ember-cli': [
            {
              name: 'addon',
              description: 'The default blueprint for ember-cli addons.',
              availableOptions: [],
              anonymousOptions: ['name'],
              overridden: false
            },
            {
              name: 'addon-import',
              description: 'Generates an import wrapper.',
              availableOptions: [],
              anonymousOptions: ['name'],
              overridden: false
            },
            {
              name: 'app',
              description: 'The default blueprint for ember-cli projects.',
              availableOptions: [],
              anonymousOptions: ['name'],
              overridden: false
            },
            {
              name: 'blueprint',
              description: 'Generates a blueprint and definition.',
              availableOptions: [],
              anonymousOptions: ['name'],
              overridden: false
            },
            {
              name: 'http-mock',
              description: 'Generates a mock api endpoint in /api prefix.',
              availableOptions: [],
              anonymousOptions: ['endpoint-path'],
              overridden: false
            },
            {
              name: 'http-proxy',
              description: 'Generates a relative proxy to another server.',
              availableOptions: [],
              anonymousOptions: ['local-path', 'remote-url'],
              overridden: false
            },
            {
              name: 'in-repo-addon',
              description: 'The blueprint for addon in repo ember-cli addons.',
              availableOptions: [],
              anonymousOptions: ['name'],
              overridden: false
            },
            {
              name: 'lib',
              description: 'Generates a lib directory for in-repo addons.',
              availableOptions: [],
              anonymousOptions: ['name'],
              overridden: false
            },
            {
              name: 'server',
              description: 'Generates a server directory for mocks and proxies.',
              availableOptions: [],
              anonymousOptions: ['name'],
              overridden: false
            }
          ]
        }
      ]
    },
    {
      name: 'help',
      description: 'Outputs the usage instructions for all commands or the provided command',
      aliases: [null, 'h', '--help', '-h'],
      works: 'everywhere',
      availableOptions: [
        {
          name: 'verbose',
          default: false,
          aliases: ['v'],
          key: 'verbose',
          required: false
        },
        {
          name: 'json',
          default: false,
          key: 'json',
          required: false
        }
      ],
      anonymousOptions: ['<command-name (Default: all)>']
    },
    {
      name: 'init',
      description: 'Reinitializes a new ember-cli project in the current folder.',
      aliases: [],
      works: 'everywhere',
      availableOptions: [
        {
          name: 'dry-run',
          default: false,
          aliases: ['d'],
          key: 'dryRun',
          required: false
        },
        {
          name: 'verbose',
          default: false,
          aliases: ['v'],
          key: 'verbose',
          required: false
        },
        {
          name: 'blueprint',
          aliases: ['b'],
          key: 'blueprint',
          required: false
        },
        {
          name: 'skip-npm',
          default: false,
          aliases: ['sn', 'skip-install', 'si'],
          key: 'skipNpm',
          required: false
        },
        {
          name: 'lint-fix',
          default: true,
          key: 'lintFix',
          required: false
        },
        {
          name: 'welcome',
          key: 'welcome',
          description: 'Installs and uses {{ember-welcome-page}}. Use --no-welcome to skip it.',
          default: true,
          required: false
        },
        {
          aliases: [{ npm: 'npm' }, { pnpm: 'pnpm' }, { yarn: 'yarn' }],
          key: 'packageManager',
          name: 'package-manager',
          required: false,
          type: ['npm', 'pnpm', 'yarn'],
        },
        {
          name: 'name',
          default: '',
          aliases: ['n'],
          key: 'name',
          required: false
        },
        {
          name: 'lang',
          key: 'lang',
          description: 'Sets the base human language of the application via index.html',
          required: false
        },
        {
          default: false,
          key: 'embroider',
          name: 'embroider',
          description: 'Deprecated: Enables the build system to use Embroider',
          required: false
        },
        {
          name: 'ci-provider',
          key: 'ciProvider',
          type: ['github', 'none'],
          default: 'github',
          description: 'Installs the optional default CI blueprint. Only Github Actions is supported at the moment.',
          required: false,
        },
        {
          name: 'ember-data',
          key: 'emberData',
          description: 'Include ember-data dependencies and configuration',
          required: false,
          default: true
        },
        {
          aliases: ['ts'],
          default: false,
          key: 'typescript',
          name: 'typescript',
          description: 'Set up the app to use TypeScript',
          required: false,
        },
        {
          default: true,
          description: 'Use GJS/GTS templates by default for generated components, tests, and route templates',
          key: 'strict',
          name: 'strict',
          required: false
        },
      ],
      anonymousOptions: ['<glob-pattern>']
    },
    {
      name: 'install',
      description: 'Installs an ember-cli addon from npm.',
      aliases: ['i'],
      works: 'insideProject',
      availableOptions: [
        {
          name: 'save',
          default: false,
          aliases: ['S'],
          key: 'save',
          required: false
        },
        {
          name: 'save-dev',
          default: true,
          aliases: ['D'],
          key: 'saveDev',
          required: false
        },
        {
          name: 'save-exact',
          default: false,
          aliases: ['E', 'exact'],
          key: 'saveExact',
          required: false
        },
        {
          aliases: [{ npm: 'npm' }, { pnpm: 'pnpm' }, { yarn: 'yarn' }],
          description:
            'Use this option to force the usage of a specific package manager. By default, ember-cli will try to detect the right package manager from any lockfiles that exist in your project.',
          key: 'packageManager',
          name: 'package-manager',
          required: false,
          type: ['npm', 'pnpm', 'yarn'],
        },
      ],
      anonymousOptions: ['<addon-name>']
    },
    {
      name: 'new',
      description: processHelpString('Creates a new directory and runs \u001b[32member init\u001b[39m in it.'),
      aliases: [],
      works: 'everywhere',
      availableOptions: [
        {
          name: 'dry-run',
          default: false,
          aliases: ['d'],
          key: 'dryRun',
          required: false
        },
        {
          name: 'verbose',
          default: false,
          aliases: ['v'],
          key: 'verbose',
          required: false
        },
        {
          name: 'blueprint',
          default: 'app',
          aliases: ['b'],
          key: 'blueprint',
          required: false
        },
        {
          name: 'skip-npm',
          default: false,
          aliases: ['sn', 'skip-install', 'si'],
          key: 'skipNpm',
          required: false
        },
        {
          name: 'skip-git',
          default: false,
          aliases: ['sg'],
          key: 'skipGit',
          required: false
        },
        {
          name: 'welcome',
          key: 'welcome',
          description: 'Installs and uses {{ember-welcome-page}}. Use --no-welcome to skip it.',
          default: true,
          required: false
        },
        {
          aliases: [{ npm: 'npm' }, { pnpm: 'pnpm' }, { yarn: 'yarn' }],
          key: 'packageManager',
          name: 'package-manager',
          required: false,
          type: ['npm', 'pnpm', 'yarn'],
        },
        {
          name: 'directory',
          aliases: ['dir'],
          key: 'directory',
          required: false
        },
        {
          name: 'lang',
          key: 'lang',
          description: 'Sets the base human language of the application via index.html',
          required: false
        },
        {
          name: 'lint-fix',
          default: true,
          key: 'lintFix',
          required: false
        },
        {
          default: false,
          key: 'embroider',
          name: 'embroider',
          description: 'Deprecated: Enables the build system to use Embroider',
          required: false
        },
        {
          name: 'ci-provider',
          key: 'ciProvider',
          type: ['github', 'none'],
          description: 'Installs the optional default CI blueprint. Only Github Actions is supported at the moment.',
          required: false,
        },
        {
          name: 'ember-data',
          key: 'emberData',
          description: 'Include ember-data dependencies and configuration',
          required: false,
          default: true
        },
        {
          name: 'interactive',
          default: false,
          aliases: ['i'],
          description: 'Create a new Ember app/addon in an interactive way.',
          key: 'interactive',
          required: false,
        },
        {
          aliases: ['ts'],
          default: false,
          key: 'typescript',
          name: 'typescript',
          description: 'Set up the app to use TypeScript',
          required: false,
        },
        {
          default: true,
          description: 'Use GJS/GTS templates by default for generated components, tests, and route templates',
          key: 'strict',
          name: 'strict',
          required: false
        },
      ],
      anonymousOptions: ['<app-name>']
    },
    {
      name: 'test',
      description: 'Runs your app\'s test suite.',
      aliases: ['t'],
      works: 'insideProject',
      availableOptions: [
        {
          name: 'environment',
          description: 'Possible values are "development", "production", and "test".',
          default: 'test',
          aliases: ['e'],
          key: 'environment',
          required: false
        },
        {
          name: 'config-file',
          aliases: ['c', 'cf'],
          key: 'configFile',
          required: false
        },
        {
          name: 'host',
          aliases: ['H'],
          key: 'host',
          required: false
        },
        {
          name: 'test-port',
          default: 7357,
          description: 'The test port to use when running tests. Pass 0 to automatically pick an available port',
          aliases: ['tp'],
          key: 'testPort',
          required: false
        },
        {
          name: 'filter',
          description: 'A string to filter tests to run',
          aliases: ['f'],
          key: 'filter',
          required: false
        },
        {
          name: 'module',
          description: 'The name of a test module to run',
          aliases: ['m'],
          key: 'module',
          required: false
        },
        {
          name: 'watcher',
          default: 'events',
          aliases: ['w'],
          key: 'watcher',
          required: false
        },
        {
          name: 'launch',
          default: false,
          description: 'A comma separated list of browsers to launch for tests.',
          key: 'launch',
          required: false
        },
        {
          name: 'reporter',
          description: 'Test reporter to use [tap|dot|xunit] (default: tap)',
          aliases: ['r'],
          key: 'reporter',
          required: false
        },
        {
          name: 'silent',
          default: false,
          description: 'Suppress any output except for the test report',
          key: 'silent',
          required: false
        },
        {
          name: 'ssl',
          default: false,
          description: 'Set to true to configure testem to run the test suite using SSL.',
          key: 'ssl',
          required: false
        },
        {
          name: 'ssl-key',
          default: 'ssl/server.key',
          description: 'Specify the private key to use for SSL.',
          key: 'sslKey',
          required: false
        },
        {
          name: 'ssl-cert',
          default: 'ssl/server.crt',
          description: 'Specify the certificate to use for SSL.',
          key: 'sslCert',
          required: false
        },
        {
          name: 'testem-debug',
          description: 'File to write a debug log from testem',
          key: 'testemDebug',
          required: false
        },
        {
          name: 'test-page',
          description: 'Test page to invoke',
          key: 'testPage',
          required: false
        },
        {
          name: 'path',
          description: 'Reuse an existing build at given path.',
          key: 'path',
          required: false,
          type: 'Path',
        },
        {
          name: 'query',
          description: 'A query string to append to the test page URL.',
          key: 'query',
          required: false
        }
      ],
      anonymousOptions: []
    },
    {
      name: 'version',
      description: 'outputs ember-cli version',
      aliases: ['v', '--version', '-v'],
      works: 'everywhere',
      availableOptions: [
        {
          name: 'verbose',
          default: false,
          key: 'verbose',
          required: false
        }
      ],
      anonymousOptions: []
    }
  ],
  addons: []
};
